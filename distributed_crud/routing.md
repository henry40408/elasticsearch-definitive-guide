### 將文件路由到從庫中

當你索引一個文件，它被儲存在單個的主分片上，Elasticsearch如何知道文件屬於哪個分片呢？
當我們建立一個新文件，它如何知道應該儲存在分片1還是分片2上呢？

這個過程不能是隨機的，因為我們將來需要取回該文件。
事實上，它是由一個非常簡單的公式來決定的:

    分片 = hash(routing) % 主分片數量

`routing` 值可以是任何的字元串， 預設是文件的 `_id` ，但也可以設定成一個自定義的值。
`routing` 字元串被傳遞到一個雜湊函數以生成一個數字，然後除以索引的主分片的數量
得到餘數 _remainder_. 餘數將總是在 `0` 到 `主分片數量 - 1` 之間, 它告訴了我們用以存放
一個特定文件的分片編號。

這解釋了為什麼主分片的數量只能在索引建立時設定、而且不能修改。
如果主分片的數量一旦在日後進行了修改，所有之前的路由值都會無效，文件再也無法被找到。

所有文件 APIs (`get`, `index`, `delete`, `bulk`, `update` 和 `mget`)
都可以接受 `routing` 參數，用以自定義 文件-到-分片 的對映。
自定義的路由將用於確保所有的文件 -- 例如屬於同一使用者的所有文件 -- 儲存在相同的分片上。
我們將在 `<<擴充套件>>` 中詳細討論你為什麼希望這麼做。
